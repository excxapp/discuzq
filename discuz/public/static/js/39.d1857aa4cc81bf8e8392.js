(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{"1iQ3":function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return n}));var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("footer",{staticClass:"login-user-footer"},["login-user"===t.pageName||"login-phone"===t.pageName?[t.qcloudSms?a("span",{on:{click:t.retrieveClick}},[t._v("忘记密码？找回")]):t._e(),t._v(" "),t.registerClose&&t.qcloudSms?a("i"):t._e(),t._v(" "),t.registerClose?a("span",{on:{click:t.signUpClick}},[t._v("注册")]):t._e()]:"wx-login-bd"===t.pageName?[a("span",{on:{click:t.wxSignUpBdClick}},[t._v("没有账号？注册，绑定微信新账号")])]:"wx-sign-up-bd"===t.pageName?[a("span",{on:{click:t.wxLoginBdClick}},[t._v("已有账号？登录，微信绑定账号")])]:"sign-up"===t.pageName?[a("span",{on:{click:t.loginClick}},[t._v("已有账号立即登录")])]:"bind-phone"===t.pageName?[a("span",{on:{click:t.homeClick}},[t._v(t._s("pay"===t.siteMode?"跳过，进入支付费用":"跳过，进入首页"))])]:(t.pageName,[a("span")])],2)},n=[]},"3AWV":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(a("QbLZ"));a("iUmJ");var n=s(a("zkMY"));function s(t){return t&&t.__esModule?t:{default:t}}e.default=(0,r.default)({name:"login-sign-up-footer"},n.default)},J4oq:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(a("QbLZ"));a("NdMT");var n=s(a("wwLr"));function s(t){return t&&t.__esModule?t:{default:t}}e.default=(0,r.default)({name:"sign-up-view"},n.default)},NdMT:function(t,e,a){},SFEY:function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return n}));var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sign-up-box"},[a("SignUpHeader"),t._v(" "),a("main",{staticClass:"sign-up-main"},[t._m(0),t._v(" "),a("form",{staticClass:"login-module-form"},[a("van-cell-group",[a("van-field",{attrs:{clearable:"",label:"用户名",placeholder:"请输入您的用户名"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),t._v(" "),a("van-field",{attrs:{clearable:"",type:"password",label:"密码",placeholder:"请填写密码",error:t.error,"error-message":t.errorMessage},on:{clear:function(e){return t.clearError("clear")},focus:function(e){return t.clearError("focus")},input:function(e){return t.clearError("input")},blur:function(e){return t.clearError("blur")}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),t._v(" "),t.signReasonStatus?a("van-field",{attrs:{clearable:"",label:"注册原因",placeholder:"请填写注册原因"},model:{value:t.signReason,callback:function(e){t.signReason=e},expression:"signReason"}}):t._e()],1)],1),t._v(" "),a("div",{staticClass:"sign-up-btn"},[t.signUpShow?a("van-button",{attrs:{loading:t.btnLoading,"loading-text":"注册中...",type:"primary"},on:{click:t.signUpClick}},[t._v("注册")]):a("van-button",{attrs:{"loading-text":"注册中...",type:"primary",id:"TencentCaptcha","data-appid":"appID"},on:{click:t.initCaptcha}},[t._v("注册")])],1)]),t._v(" "),a("SignUpFooter")],1)},n=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"login-module-title-box"},[e("p",{staticClass:"login-module-title"},[this._v("注册")])])}]},UjaL:function(t,e,a){"use strict";a.r(e);var r=a("1iQ3"),n=a("pz4+");for(var s in n)"default"!==s&&function(t){a.d(e,t,(function(){return n[t]}))}(s);var i=a("KHd+"),o=Object(i.a)(n.default,r.a,r.b,!1,null,null,null);e.default=o.exports},fb1Y:function(t,e,a){"use strict";a.r(e);var r=a("SFEY"),n=a("vMx2");for(var s in n)"default"!==s&&function(t){a.d(e,t,(function(){return n[t]}))}(s);var i=a("KHd+"),o=Object(i.a)(n.default,r.a,r.b,!1,null,null,null);e.default=o.exports},"pz4+":function(t,e,a){"use strict";a.r(e);var r=a("3AWV"),n=a.n(r);for(var s in r)"default"!==s&&function(t){a.d(e,t,(function(){return r[t]}))}(s);e.default=n.a},vMx2:function(t,e,a){"use strict";a.r(e);var r=a("J4oq"),n=a.n(r);for(var s in r)"default"!==s&&function(t){a.d(e,t,(function(){return r[t]}))}(s);e.default=n.a},wwLr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(a("JZuw")),n=i(a("UjaL")),s=i(a("VVfg"));function i(t){return t&&t.__esModule?t:{default:t}}e.default={data:function(){return{username:"",password:"",signReason:"",signReasonStatus:!1,btnLoading:!1,error:!1,errorMessage:"",phoneStatus:"",siteMode:"",signUpShow:!0,appID:"",captcha:null,captcha_ticket:"",captcha_rand_str:""}},components:{SignUpHeader:r.default,SignUpFooter:n.default},methods:{signUpClick:function(){this.btnLoading=!0,this.signReasonStatus&&this.signReason.length<1?(this.$toast.fail("请填写注册原因！"),this.btnLoading=!1):this.setSignData()},clearError:function(t){switch(t){case"clear":this.error=!1,this.errorMessage="";break;case"blur":""!==this.password&&(this.error=!0);break;default:this.error=!1}},getForum:function(){var t=this;return this.appFetch({url:"forum",method:"get",data:{}}).then((function(e){e.errors?e.errors[0].detail?t.$toast.fail(e.errors[0].code+"\n"+e.errors[0].detail[0]):t.$toast.fail(e.errors[0].code):(t.phoneStatus=e.readdata._data.qcloud.qcloud_sms,t.siteMode=e.readdata._data.set_site.site_mode,t.signReasonStatus=e.readdata._data.set_reg.register_validate,t.appID=e.readdata._data.qcloud.qcloud_captcha_app_id,s.default.setLItem("siteInfo",e.readdata),e.readdata._data.qcloud.qcloud_captcha&&e.readdata._data.set_reg.register_captcha&&(t.signUpShow=!1))})).catch((function(t){}))},setSignData:function(){var t=this;this.appFetch({url:"register",method:"post",data:{data:{type:"users",attributes:{username:this.username,password:this.password,register_reason:this.signReason,captcha_ticket:this.captcha_ticket,captcha_rand_str:this.captcha_rand_str}}}}).then((function(e){t.btnLoading=!1,t.getForum().then((function(){if(e.errors)e.errors[0].detail?t.$toast.fail(e.errors[0].code+"\n"+e.errors[0].detail[0]):"register_validate"===e.rawData[0].code?t.$router.push({path:"information-page",query:{setInfo:"registrationReview"}}):t.$toast.fail(e.errors[0].code);else{t.$toast.success("注册成功");var a=e.data.attributes.access_token,r=e.data.id,n=e.data.attributes.refresh_token;s.default.setLItem("Authorization",a),s.default.setLItem("tokenId",r),s.default.setLItem("refreshToken",n),t.phoneStatus?t.$router.push({path:"bind-phone"}):"pay"===t.siteMode?t.$router.push({path:"pay-the-fee"}):"public"===t.siteMode&&t.$router.push({path:"/"})}}))})).catch((function(t){}))},initCaptcha:function(){var t=this;""!==this.username?""!==this.password?(this.captcha=new TencentCaptcha(this.appID,(function(e){0===e.ret&&(t.captcha_ticket=e.ticket,t.captcha_rand_str=e.randstr,t.setSignData())})),this.captcha.show()):this.$toast("密码不能为空"):this.$toast("用户名不能为空")}},created:function(){this.getForum()},beforeRouteLeave:function(t,e,a){this.captcha&&this.captcha.destroy(),a()}}},zkMY:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,n=a("VVfg"),s=(r=n)&&r.__esModule?r:{default:r};e.default={data:function(){return{pageName:"login",siteMode:"",registerClose:!0,qcloudSms:!0}},methods:{retrieveClick:function(){this.$router.push("retrieve-pwd")},signUpClick:function(){this.$router.push("sign-up")},wxSignUpBdClick:function(){this.$router.push("/wx-sign-up-bd")},wxLoginBdClick:function(){this.$router.push("/wx-login-bd")},loginClick:function(){this.$router.push("/login-user")},homeClick:function(){switch(this.siteMode){case"pay":this.$router.push({path:"pay-the-fee"});break;case"public":this.$router.push({path:"/"})}},getForum:function(){var t=this;this.appFetch({url:"forum",method:"get",data:{}}).then((function(e){t.siteMode=e.readdata._data.set_site.site_mode,t.registerClose=e.readdata._data.set_reg.register_close,t.qcloudSms=e.readdata._data.qcloud.qcloud_sms,s.default.setLItem("siteInfo",e.readdata)})).catch((function(t){}))}},created:function(){this.pageName=this.$router.history.current.name,this.getForum()}}}}]);