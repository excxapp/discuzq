(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{"7HMf":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s(a("JZuw")),i=s(a("H68H")),r=s(a("VVfg"));function s(t){return t&&t.__esModule?t:{default:t}}e.default={data:function(){return{payee:"",canWithdraw:"",withdrawalAmount:"",number:"",handlingFee:"",phone:"",bind:"verify",sms:"",show:!1,sendStatus:!0,time:1,insterVal:"",isGray:!1,btnContent:"发送验证码",wechatNickname:"",mobileConfirmed:"",handlingFee1:""}},components:{WithdrawHeader:n.default,Panenl:i.default},created:function(){this.withdrawUser()},computed:{lingFee:function(){var t=Math.round(this.handlingFee1*this.withdrawalAmount*100)/100;return t+"元 （"+this.handlingFee+"）"},actualCashWithdrawal:function(){var t=Math.round(this.handlingFee1*this.withdrawalAmount*100);return""===this.withdrawalAmount?"":Math.round(100*this.withdrawalAmount-t)/100}},methods:{withdrawInput:function(t){this.handleReg()},formatter:function(t){return this.handleReg(t)},onInput:function(t){this.withdrawalAmount=this.handleReg(this.withdrawalAmount+t.toString())},handleReg:function(t){return 0==(t=t.toString()).indexOf(".")&&(t="0."),(t=(t=(t=(t=t.replace(/[^\d.]/g,"")).replace(/\.{2,}/g,".")).replace(".","$#$").replace(/\./g,"").replace("$#$",".")).replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3")).indexOf(".")<0&&""!=t&&(t=parseFloat(t)),t},onDelete:function(){this.withdrawalAmount=this.withdrawalAmount.slice(0,-1)},withdrawUser:function(){var t=this,e=r.default.getLItem("tokenId");this.appFetch({url:"users",method:"get",splice:"/"+e,data:{include:"wechat"}}).then((function(e){e.errors?t.$toast.fail(e.errors[0].code):(t.payee=e.data.attributes.username,t.phone=e.data.attributes.mobile,e.readdata.wechat&&(t.wechatNickname=e.readdata.wechat._data.nickname))})),this.appFetch({url:"wallet",method:"get",splice:e,data:{include:""}}).then((function(e){if(e.errors)t.$toast.fail(e.errors[0].code);else{var a=parseFloat(e.data.attributes.available_amount).toFixed(3),n=a.substring(0,a.length-1);t.canWithdraw=n,t.handlingFee=e.data.attributes.cash_tax_ratio+"%",t.handlingFee1=e.data.attributes.cash_tax_ratio/100}}))},sendVerificationCode:function(){var t=this;(0!=this.canWithdraw&&""!=this.phone||(this.sendStatus=!1),this.wechatNickname)?this.phone?this.appFetch({url:"sendSms",method:"post",data:{data:{attributes:{type:this.bind}}}}).then((function(e){e.errors?t.$toast.fail(e.errors[0].code):(t.insterVal=e.data.attributes.interval,t.time=t.insterVal,t.timer())})):this.$toast("请先绑定手机号"):this.$toast("请绑定微信")},timer:function(){if(this.time>1){this.time--,this.btnContent=this.time+"s后重新获取",this.disabled=!0;var t=setTimeout(this.timer,1e3);this.isGray=!0}else 1==this.time&&(this.btnContent="获取验证码",clearTimeout(t),this.disabled=!1,this.isGray=!1)},withdraw:function(){var t=this,e=this.withdrawalAmount,a=this.sms,n=this.canWithdraw;e?a?0!=n?(this.appFetch({url:"smsVerify",method:"post",data:{data:{attributes:{mobile:this.phone,code:this.sms,type:this.bind}}}}).then((function(e){e.errors?t.$toast.fail(e.errors[0].code):(t.mobileConfirmed=e.readdata._data.mobileConfirmed,1==t.mobileConfirmed&&t.$toast("提现申请已提交，请等待审核"))})),this.phone?this.wechatNickname?this.appFetch({url:"cash",method:"post",data:{cash_apply_amount:this.withdrawalAmount}}).then((function(e){e.errors?t.$toast.fail(e.errors[0].code):(t.canWithdraw=e.data.attributes.cash_apply_amount,t.handlingFee=e.data.attributes.cash_charge)})):this.$toast("请绑定微信"):this.$toast("请先绑定手机号")):this.$toast("可提现金额不足"):this.$toast("请输入验证码"):this.$toast("请输入提现金额")}}}},DUdu:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"withdraw-box"},[a("WithdrawHeader",{attrs:{title:"提现"}}),t._v(" "),a("main",{staticClass:"withdraw-main"},[a("div",{staticClass:"withdraw-form my-info-form"},[a("van-cell-group",[a("van-field",{attrs:{label:"收款人 ",placeholder:"请输入收款人",readonly:""},model:{value:t.payee,callback:function(e){t.payee=e},expression:"payee"}}),t._v(" "),a("van-field",{attrs:{label:"可提现金额 ",placeholder:"可提现金额",readonly:""},model:{value:t.canWithdraw,callback:function(e){t.canWithdraw=e},expression:"canWithdraw"}}),t._v(" "),a("van-field",{attrs:{type:"number",clearable:"",label:"提现金额 ",placeholder:"请输入提现金额",formatter:t.formatter},nativeOn:{touchstart:function(e){e.stopPropagation(),t.show=!0}},model:{value:t.withdrawalAmount,callback:function(e){t.withdrawalAmount=e},expression:"withdrawalAmount"}}),t._v(" "),a("van-number-keyboard",{attrs:{show:t.show,theme:"custom",title:"站点金额键盘","extra-key":".","close-button-text":"完成",type:"number"},on:{blur:function(e){t.show=!1},input:t.onInput,delete:t.onDelete},model:{value:t.number,callback:function(e){t.number=e},expression:"number"}}),t._v(" "),a("van-field",{attrs:{label:"手续费",placeholder:"手续费",readonly:""},model:{value:t.lingFee,callback:function(e){t.lingFee=e},expression:"lingFee"}}),t._v(" "),a("van-field",{attrs:{label:"实际提现金额",placeholder:"实际提现金额",readonly:""},model:{value:t.actualCashWithdrawal,callback:function(e){t.actualCashWithdrawal=e},expression:"actualCashWithdrawal"}}),t._v(" "),a("van-field",{attrs:{label:"手机号",placeholder:"手机号",readonly:""},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}}),t._v(" "),a("van-field",{attrs:{clearable:"",label:"验证码 ",type:"number",placeholder:"请输入验证码"},model:{value:t.sms,callback:function(e){t.sms=e},expression:"sms"}},[a("van-button",{attrs:{slot:"button",size:"small",type:"default",sendStatus:t.sendStatus},on:{click:t.sendVerificationCode},slot:"button"},[t._v(t._s(t.btnContent))])],1)],1)],1),t._v(" "),a("div",{staticClass:"withdraw-operating"},[a("van-button",{attrs:{type:"primary"},on:{click:t.withdraw}},[t._v("提交")])],1)])],1)},i=[]},H68H:function(t,e,a){"use strict";a.r(e);var n=a("aOFr"),i=a("VIDA");for(var r in i)"default"!==r&&function(t){a.d(e,t,(function(){return i[t]}))}(r);var s=a("KHd+"),l=Object(s.a)(i.default,n.a,n.b,!1,null,null,null);e.default=l.exports},VIDA:function(t,e,a){"use strict";a.r(e);var n=a("cOC8"),i=a.n(n);for(var r in n)"default"!==r&&function(t){a.d(e,t,(function(){return n[t]}))}(r);e.default=i.a},aK2N:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(a("QbLZ"));a("iUmJ"),a("llYx");var i=r(a("7HMf"));function r(t){return t&&t.__esModule?t:{default:t}}e.default=(0,n.default)({name:"withdraw-view"},i.default)},aOFr:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"panel-box",on:{click:t.boxClick}},[a("div",{staticClass:"panel-header"},[a("div",{staticClass:"panel-header-lf"},[a("span",{domProps:{innerHTML:t._s(t.titles)}})]),t._v(" "),a("div",{staticClass:"panel-header-rh"},[a("span",{class:t.status?"add-orange":""},[t._v("\n        "+t._s(t.nums)+"\n      ")])])]),t._v(" "),a("div",{staticClass:"panel-bottom",on:{click:t.labelClick}},[t._t("label")],2)])},i=[]},cOC8:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(a("QbLZ")),i=r(a("tNAK"));function r(t){return t&&t.__esModule?t:{default:t}}a("iUmJ"),e.default=(0,n.default)({name:"panel"},i.default)},gBJP:function(t,e,a){"use strict";a.r(e);var n=a("DUdu"),i=a("zUvY");for(var r in i)"default"!==r&&function(t){a.d(e,t,(function(){return i[t]}))}(r);var s=a("KHd+"),l=Object(s.a)(i.default,n.a,n.b,!1,null,null,null);e.default=l.exports},llYx:function(t,e,a){},tNAK:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{titles:this.title,nums:this.num}},props:{title:{default:"标题",type:String},num:{default:"0.00",type:String},type:{type:String},status:{default:!1,type:Boolean}},methods:{boxClick:function(){this.$emit("click")},labelClick:function(){this.$emit("labelClick")}},mounted:function(){}}},zUvY:function(t,e,a){"use strict";a.r(e);var n=a("aK2N"),i=a.n(n);for(var r in n)"default"!==r&&function(t){a.d(e,t,(function(){return n[t]}))}(r);e.default=i.a}}]);